<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Игра на удачу</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Arial', sans-serif;
        }
        
        body {
            background: white;
            color: #333;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .container {
            width: 100%;
            max-width: 800px;
            background: #f9f9f9;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            border: 1px solid #e0e0e0;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        h1 {
            color: #2c3e50;
            margin-bottom: 15px;
        }
        
        .stats {
            display: flex;
            justify-content: center;
            gap: 30px;
            font-size: 18px;
            margin-bottom: 20px;
        }
        
        .coins {
            color: #e67e22;
            font-weight: bold;
        }
        
        .cooldown {
            color: #e74c3c;
            font-weight: bold;
        }
        
        .result-area {
            text-align: center;
            margin: 30px 0;
            min-height: 100px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        
        .result-label {
            font-size: 18px;
            color: #7f8c8d;
            margin-bottom: 10px;
        }
        
        .result {
            font-size: 36px;
            font-weight: bold;
            padding: 15px 30px;
            margin: 10px 0;
            transition: all 0.3s;
            text-align: center;
            width: 100%;
        }
        
        .spin-btn {
            background: #3498db;
            color: white;
            border: none;
            padding: 20px 50px;
            font-size: 22px;
            border-radius: 50px;
            cursor: pointer;
            margin: 20px auto;
            display: block;
            transition: all 0.3s;
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.3);
        }
        
        .spin-btn:hover:not(:disabled) {
            background: #2980b9;
            transform: scale(1.05);
        }
        
        .spin-btn:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
        }
        
        .tabs {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
            gap: 10px;
        }
        
        .tab-btn {
            background: #e0e0e0;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .tab-btn.active {
            background: #3498db;
            color: white;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .shop-items {
            display: grid;
            grid-template-columns: 1fr;
            gap: 10px;
        }
        
        .shop-item {
            background: white;
            padding: 12px;
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid #e0e0e0;
        }
        
        .shop-btn {
            background: #2ecc71;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
            white-space: nowrap;
            margin-left: 10px;
        }
        
        .shop-btn:hover:not(:disabled) {
            background: #27ae60;
        }
        
        .shop-btn:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
        }
        
        .inventory-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
            gap: 10px;
            margin-top: 20px;
        }
        
        .inventory-item {
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .inventory-item:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .sphere {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            margin: 0 auto 5px;
        }
        
        .craft-item {
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
        }
        
        .craft-title {
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .craft-recipe {
            display: flex;
            align-items: center;
            gap: 5px;
            margin-bottom: 10px;
            flex-wrap: wrap;
        }
        
        .craft-sphere {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: inline-block;
        }
        
        .craft-btn {
            background: #9b59b6;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
        }
        
        .craft-btn:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
        }
        
        .discovered {
            margin-top: 30px;
            background: white;
            padding: 15px;
            border-radius: 10px;
            border: 1px solid #e0e0e0;
        }
        
        .discovered h3 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 10px;
        }
        
        .items-list {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
        }
        
        .item {
            padding: 8px 12px;
            border-radius: 5px;
            font-size: 14px;
            background: #f1f1f1;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .item-chance {
            font-size: 12px;
            color: #7f8c8d;
            background: #e0e0e0;
            padding: 2px 6px;
            border-radius: 10px;
        }
        
        /* Цвета для различных типов предметов */
        .common { color: #95a5a6; }
        .common-sphere { background: #95a5a6; }
        .uncommon { color: #3498db; }
        .uncommon-sphere { background: #3498db; }
        .rare { color: #2ecc71; }
        .rare-sphere { background: #2ecc71; }
        .improved { color: #f1c40f; }
        .improved-sphere { background: #f1c40f; }
        .epic { color: #e67e22; }
        .epic-sphere { background: #e67e22; }
        .legendary { color: #e74c3c; }
        .legendary-sphere { background: #e74c3c; }
        .mythical { color: #9b59b6; }
        .mythical-sphere { background: #9b59b6; }
        .shadow-light { 
            background: linear-gradient(to right, #2c3e50, #8e44ad);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .shadow-light-sphere { 
            background: linear-gradient(45deg, #2c3e50, #8e44ad);
        }
        .purple { color: #8e44ad; }
        .purple-sphere { background: #8e44ad; }
        .king { color: #d35400; }
        .king-sphere { background: #d35400; }
        .mega { color: #c0392b; }
        .mega-sphere { background: #c0392b; }
        .angel { color: #16a085; }
        .angel-sphere { background: #16a085; }
        .divine { 
            background: linear-gradient(to right, #2980b9, #e74c3c);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .divine-sphere { 
            background: linear-gradient(45deg, #2980b9, #e74c3c);
        }
        .eternity { color: #2c3e50; }
        .eternity-sphere { background: #2c3e50; }
        .heart { color: #e74c3c; }
        .heart-sphere { background: #e74c3c; }
        .error { color: #8e44ad; }
        .error-sphere { background: #8e44ad; }
        
        /* Анимации */
        .animation-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.95);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 100;
            flex-direction: column;
        }
        
        .divine-text {
            font-size: 60px;
            font-weight: bold;
            color: #e74c3c;
            animation: shake 0.1s infinite;
        }
        
        .eternity-text {
            font-size: 60px;
            font-weight: bold;
            color: #2c3e50;
            animation: pulse 2s infinite;
        }
        
        .heart-text {
            font-size: 60px;
            font-weight: bold;
            color: #e74c3c;
            animation: heartbeat 1s infinite;
        }
        
        .error-text {
            font-size: 60px;
            font-weight: bold;
            color: #8e44ad;
            animation: glitch 1s infinite;
        }
        
        @keyframes shake {
            0% { transform: translate(0, 0) rotate(0deg); }
            25% { transform: translate(5px, 5px) rotate(5deg); }
            50% { transform: translate(0, 0) rotate(0deg); }
            75% { transform: translate(-5px, 5px) rotate(-5deg); }
            100% { transform: translate(0, 0) rotate(0deg); }
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        @keyframes heartbeat {
            0% { transform: scale(1); }
            25% { transform: scale(1.1); }
            50% { transform: scale(1); }
            75% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        @keyframes glitch {
            0% { transform: translate(0); }
            20% { transform: translate(-5px, 5px); }
            40% { transform: translate(-5px, -5px); }
            60% { transform: translate(5px, 5px); }
            80% { transform: translate(5px, -5px); }
            100% { transform: translate(0); }
        }
        
        .explosion {
            position: absolute;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            animation: explode 1s forwards;
        }
        
        @keyframes explode {
            0% { transform: scale(1); opacity: 1; }
            100% { transform: scale(20); opacity: 0; }
        }
        
        .white-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: white;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 101;
            flex-direction: column;
        }
        
        .black-text {
            font-size: 24px;
            color: black;
            text-align: center;
            max-width: 80%;
        }
        
        @media (max-width: 768px) {
            .stats {
                flex-direction: column;
                gap: 10px;
            }
            
            .result {
                font-size: 28px;
                padding: 10px 20px;
            }
            
            .spin-btn {
                padding: 15px 30px;
                font-size: 18px;
            }
            
            .inventory-grid {
                grid-template-columns: repeat(auto-fill, minmax(60px, 1fr));
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ИГРА НА УДАЧУ</h1>
            <div class="stats">
                <div class="coins">Монеты: <span id="coins">0</span></div>
                <div class="cooldown">Перезарядка: <span id="cooldown">5.0</span> сек</div>
            </div>
        </header>
        
        <div class="result-area">
            <div class="result-label">Результат:</div>
            <div class="result" id="result">Нажмите "Крутить" чтобы начать</div>
        </div>
        
        <button class="spin-btn" id="spin-btn">Крутить (5.0 сек)</button>
        
        <div class="tabs">
            <button class="tab-btn active" data-tab="shop">Магазин</button>
            <button class="tab-btn" data-tab="inventory">Инвентарь</button>
            <button class="tab-btn" data-tab="craft">Крафт</button>
        </div>
        
        <div class="tab-content active" id="shop">
            <h2>Магазин улучшений</h2>
            <div class="shop-items">
                <div class="shop-item">
                    <span>Уменьшить перезарядку на 0.5 сек</span>
                    <button class="shop-btn" id="upgrade-cooldown">25 монет</button>
                </div>
            </div>
            
            <div class="luck-items">
                <h3>Улучшение удачи</h3>
                <div class="shop-item">
                    <span>Удалить Обычный</span>
                    <button class="shop-btn" id="remove-common">100 монет</button>
                </div>
                <div class="shop-item">
                    <span>Удалить Необычный</span>
                    <button class="shop-btn" id="remove-uncommon">200 монет</button>
                </div>
                <div class="shop-item">
                    <span>Удалить Редкий</span>
                    <button class="shop-btn" id="remove-rare">325 монет</button>
                </div>
                <div class="shop-item">
                    <span>Удалить Повышенный</span>
                    <button class="shop-btn" id="remove-improved">500 монет</button>
                </div>
                <div class="shop-item">
                    <span>Удалить Эпический</span>
                    <button class="shop-btn" id="remove-epic">1000 монет</button>
                </div>
                <div class="shop-item">
                    <span>Удалить Легендарный</span>
                    <button class="shop-btn" id="remove-legendary">2000 монет</button>
                </div>
                <div class="shop-item">
                    <span>Удалить Мифический</span>
                    <button class="shop-btn" id="remove-mythical">3500 монет</button>
                </div>
                <div class="shop-item">
                    <span>Удалить Тень/Свет</span>
                    <button class="shop-btn" id="remove-shadow-light">5000 монет</button>
                </div>
                <div class="shop-item">
                    <span>Удалить Фиолетовый</span>
                    <button class="shop-btn" id="remove-purple">7500 монет</button>
                </div>
                <div class="shop-item">
                    <span>Удалить КОРОЛЬ</span>
                    <button class="shop-btn" id="remove-king">10000 монет</button>
                </div>
                <div class="shop-item">
                    <span>Удалить АНГЕЛ</span>
                    <button class="shop-btn" id="remove-angel">25000 монет</button>
                </div>
                <div class="shop-item">
                    <span>Удалить БОЖЕСТВЕННЫЙ</span>
                    <button class="shop-btn" id="remove-divine">50000 монет</button>
                </div>
                <div class="shop-item">
                    <span>Удалить СЕРДЦЕ</span>
                    <button class="shop-btn" id="remove-heart">100000 монет</button>
                </div>
            </div>
        </div>
        
        <div class="tab-content" id="inventory">
            <h2>Инвентарь</h2>
            <div class="inventory-grid" id="inventory-grid">
                <!-- Здесь будут отображаться предметы инвентаря -->
            </div>
        </div>
        
        <div class="tab-content" id="craft">
            <h2>Крафт</h2>
            <div class="craft-item">
                <div class="craft-title">Большая сфера обычного</div>
                <div class="craft-recipe">
                    <span>10x</span><div class="craft-sphere common-sphere"></div><span>Обычный</span>
                </div>
                <button class="craft-btn" id="craft-common-large">Создать</button>
            </div>
            <div class="craft-item">
                <div class="craft-title">Большая сфера необычного</div>
                <div class="craft-recipe">
                    <span>10x</span><div class="craft-sphere uncommon-sphere"></div><span>Необычный</span>
                </div>
                <button class="craft-btn" id="craft-uncommon-large">Создать</button>
            </div>
            <div class="craft-item">
                <div class="craft-title">Зелье монет</div>
                <div class="craft-recipe">
                    <span>1x</span><div class="craft-sphere common-sphere"></div><span>Большая обычная</span>
                    <span>+ 1x</span><div class="craft-sphere uncommon-sphere"></div><span>Большая необычная</span>
                </div>
                <button class="craft-btn" id="craft-coin-potion">Создать</button>
            </div>
            <!-- Добавьте другие рецепты крафта здесь -->
        </div>
        
        <div class="discovered">
            <h3>Открытые предметы</h3>
            <div class="items-list" id="items-list">
                <!-- Здесь будут отображаться открытые предметы -->
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Элементы DOM
            const spinBtn = document.getElementById('spin-btn');
            const result = document.getElementById('result');
            const coinsElement = document.getElementById('coins');
            const cooldownElement = document.getElementById('cooldown');
            const itemsList = document.getElementById('items-list');
            const inventoryGrid = document.getElementById('inventory-grid');
            const tabBtns = document.querySelectorAll('.tab-btn');
            const tabContents = document.querySelectorAll('.tab-content');
            
            // Кнопки магазина
            const upgradeCooldownBtn = document.getElementById('upgrade-cooldown');
            const removeCommonBtn = document.getElementById('remove-common');
            const removeUncommonBtn = document.getElementById('remove-uncommon');
            const removeRareBtn = document.getElementById('remove-rare');
            const removeImprovedBtn = document.getElementById('remove-improved');
            const removeEpicBtn = document.getElementById('remove-epic');
            const removeLegendaryBtn = document.getElementById('remove-legendary');
            const removeMythicalBtn = document.getElementById('remove-mythical');
            const removeShadowLightBtn = document.getElementById('remove-shadow-light');
            const removePurpleBtn = document.getElementById('remove-purple');
            const removeKingBtn = document.getElementById('remove-king');
            const removeAngelBtn = document.getElementById('remove-angel');
            const removeDivineBtn = document.getElementById('remove-divine');
            const removeHeartBtn = document.getElementById('remove-heart');
            
            // Кнопки крафта
            const craftCommonLargeBtn = document.getElementById('craft-common-large');
            const craftUncommonLargeBtn = document.getElementById('craft-uncommon-large');
            const craftCoinPotionBtn = document.getElementById('craft-coin-potion');
            
            // Игровые переменные
            let coins = 0;
            let cooldown = 5.0;
            let cooldownUpgrades = 0;
            let canSpin = true;
            let discoveredItems = new Map();
            let inventory = {};
            let activeEffects = {
                coinMultiplier: 1,
                nextItem: null,
                sphereChance: 0,
                cooldownReduction: 0
            };
            
            // Шансы выпадения предметов (в порядке убывания редкости)
            const items = [
                { name: "Обычный", chance: 1/3, reward: 1, removed: false, color: "common", sphere: "common-sphere" },
                { name: "Необычный", chance: 1/5, reward: 3, removed: false, color: "uncommon", sphere: "uncommon-sphere" },
                { name: "Редкий", chance: 1/8, reward: 5, removed: false, color: "rare", sphere: "rare-sphere" },
                { name: "Повышенный", chance: 1/12, reward: 8, removed: false, color: "improved", sphere: "improved-sphere" },
                { name: "Эпический", chance: 1/15, reward: 10, removed: false, color: "epic", sphere: "epic-sphere" },
                { name: "Легендарный", chance: 1/20, reward: 15, removed: false, color: "legendary", sphere: "legendary-sphere" },
                { name: "Мифический", chance: 1/25, reward: 25, removed: false, color: "mythical", sphere: "mythical-sphere" },
                { name: "Тень/Свет", chance: 1/50, reward: 40, removed: false, color: "shadow-light", sphere: "shadow-light-sphere" },
                { name: "Фиолетовый", chance: 1/75, reward: 60, removed: false, color: "purple", sphere: "purple-sphere" },
                { name: "КОРОЛЬ", chance: 1/100, reward: 90, removed: false, color: "king", sphere: "king-sphere" },
                { name: "МЕГА", chance: 1/150, reward: 125, removed: false, color: "mega", sphere: "mega-sphere" },
                { name: "АНГЕЛ", chance: 1/200, reward: 200, removed: false, color: "angel", sphere: "angel-sphere" },
                { name: "БОЖЕСТВЕННЫЙ", chance: 1/500, reward: 500, removed: false, color: "divine", sphere: "divine-sphere" },
                { name: "ВЕЧНОСТЬ", chance: 1/3333, reward: 2500, removed: false, color: "eternity", sphere: "eternity-sphere" },
                { name: "СЕРДЦЕ", chance: 1/1666, reward: 1000, removed: false, color: "heart", sphere: "heart-sphere" },
                { name: "ERROR", chance: 1/5000, reward: 4004, removed: false, color: "error", sphere: "error-sphere" }
            ];
            
            // Инициализация инвентаря
            function initInventory() {
                for (const item of items) {
                    inventory[item.name] = 0;
                }
                inventory["Большая сфера обычного"] = 0;
                inventory["Большая сфера необычного"] = 0;
                inventory["Зелье монет"] = 0;
                // Добавьте другие крафтовые предметы здесь
            }
            
            // Обновление отображения монет
            function updateCoins() {
                coinsElement.textContent = coins;
            }
            
            // Обновление отображения перезарядки
            function updateCooldown() {
                const actualCooldown = Math.max(0.1, cooldown - activeEffects.cooldownReduction);
                cooldownElement.textContent = actualCooldown.toFixed(1);
                spinBtn.textContent = `Крутить (${actualCooldown.toFixed(1)} сек)`;
            }
            
            // Переключение вкладок
            tabBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    const tab = btn.getAttribute('data-tab');
                    
                    tabBtns.forEach(b => b.classList.remove('active'));
                    tabContents.forEach(c => c.classList.remove('active'));
                    
                    btn.classList.add('active');
                    document.getElementById(tab).classList.add('active');
                    
                    if (tab === 'inventory') {
                        updateInventoryDisplay();
                    }
                });
            });
            
            // Функция "кручения"
            function spin() {
                if (!canSpin) return;
                
                canSpin = false;
                spinBtn.disabled = true;
                
                // Определение результата после небольшой задержки
                setTimeout(() => {
                    let selectedItem;
                    
                    // Проверяем, есть ли активный эффект следующего предмета
                    if (activeEffects.nextItem) {
                        selectedItem = items.find(item => item.name === activeEffects.nextItem);
                        activeEffects.nextItem = null;
                    } else {
                        // Вычисление результата на основе шансов
                        let random = Math.random();
                        let cumulativeChance = 0;
                        
                        // Сначала вычисляем общую сумму шансов доступных предметов
                        let totalChance = 0;
                        for (const item of items) {
                            if (!item.removed) {
                                totalChance += item.chance;
                            }
                        }
                        
                        // Нормализуем шансы и выбираем предмет
                        for (const item of items) {
                            if (item.removed) continue;
                            
                            // Нормализованный шанс с учетом удаленных предметов
                            const normalizedChance = item.chance / totalChance;
                            cumulativeChance += normalizedChance;
                            
                            if (random <= cumulativeChance) {
                                selectedItem = item;
                                break;
                            }
                        }
                    }
                    
                    // Если все предметы удалены (маловероятно, но на всякий случай)
                    if (!selectedItem) {
                        selectedItem = items[items.length - 1];
                    }
                    
                    // Добавление монет за выигрыш (с учетом множителя)
                    const reward = Math.floor(selectedItem.reward * activeEffects.coinMultiplier);
                    coins += reward;
                    updateCoins();
                    
                    // Добавление в открытые предметы, если еще не открыт
                    if (!discoveredItems.has(selectedItem.name)) {
                        addDiscoveredItem(selectedItem.name, selectedItem.chance, selectedItem.color);
                    }
                    
                    // Проверка на выпадение сферы (25% шанс или 100% с активным эффектом)
                    const sphereChance = activeEffects.sphereChance > 0 ? 1 : 0.25;
                    if (Math.random() <= sphereChance) {
                        inventory[selectedItem.name]++;
                        if (activeEffects.sphereChance > 0) activeEffects.sphereChance--;
                        updateInventoryDisplay();
                    }
                    
                    // Отображение результата (только название без информации о монетах)
                    result.textContent = selectedItem.name;
                    result.className = 'result';
                    result.classList.add(selectedItem.color);
                    
                    // Проверка на специальные предметы для анимации
                    if (selectedItem.name === "БОЖЕСТВЕННЫЙ") {
                        showDivineAnimation();
                    } else if (selectedItem.name === "ВЕЧНОСТЬ") {
                        showEternityAnimation();
                    } else if (selectedItem.name === "СЕРДЦЕ") {
                        showHeartAnimation();
                    } else if (selectedItem.name === "ERROR") {
                        showErrorAnimation();
                    }
                    
                    // Включение кнопки после перезарядки (с учетом уменьшения)
                    const actualCooldown = Math.max(0.1, cooldown - activeEffects.cooldownReduction);
                    setTimeout(() => {
                        canSpin = true;
                        spinBtn.disabled = false;
                    }, actualCooldown * 1000);
                    
                }, 300); // Небольшая задержка для ощущения "кручения"
            }
            
            // Добавление открытого предмета в список с отображением шанса
            function addDiscoveredItem(itemName, chance, colorClass) {
                const itemElement = document.createElement('div');
                itemElement.classList.add('item');
                itemElement.id = `item-${itemName}`;
                
                const nameSpan = document.createElement('span');
                nameSpan.textContent = itemName;
                nameSpan.classList.add(colorClass);
                
                const chanceSpan = document.createElement('span');
                chanceSpan.classList.add('item-chance');
                chanceSpan.textContent = `${(chance * 100).toFixed(2)}%`;
                
                itemElement.appendChild(nameSpan);
                itemElement.appendChild(chanceSpan);
                
                itemsList.appendChild(itemElement);
                discoveredItems.set(itemName, itemElement);
            }
            
            // Удаление предмета из списка открытых
            function removeDiscoveredItem(itemName) {
                if (discoveredItems.has(itemName)) {
                    const itemElement = discoveredItems.get(itemName);
                    itemElement.remove();
                    discoveredItems.delete(itemName);
                }
            }
            
            // Обновление отображения инвентаря
            function updateInventoryDisplay() {
                inventoryGrid.innerHTML = '';
                
                for (const [itemName, count] of Object.entries(inventory)) {
                    if (count > 0) {
                        const item = items.find(i => i.name === itemName) || { sphere: 'common-sphere', color: 'common' };
                        
                        const itemElement = document.createElement('div');
                        itemElement.classList.add('inventory-item');
                        itemElement.innerHTML = `
                            <div class="sphere ${item.sphere || 'common-sphere'}"></div>
                            <div>${itemName}</div>
                            <div>${count}</div>
                        `;
                        
                        // Добавляем обработчик клика для использования предметов
                        if (itemName.includes("Большая сфера") || itemName.includes("Зелье")) {
                            itemElement.addEventListener('click', () => useInventoryItem(itemName));
                        }
                        
                        inventoryGrid.appendChild(itemElement);
                    }
                }
            }
            
            // Использование предмета из инвентаря
            function useInventoryItem(itemName) {
                if (inventory[itemName] > 0) {
                    inventory[itemName]--;
                    
                    // Применяем эффекты в зависимости от предмета
                    if (itemName === "Большая сфера обычного") {
                        activeEffects.nextItem = "Обычный";
                    } else if (itemName === "Большая сфера необычного") {
                        activeEffects.nextItem = "Необычный";
                    } else if (itemName === "Зелье монет") {
                        activeEffects.coinMultiplier = 1.25;
                        setTimeout(() => {
                            activeEffects.coinMultiplier = 1;
                        }, 60000); // 1 минута
                    }
                    // Добавьте другие эффекты здесь
                    
                    updateInventoryDisplay();
                }
            }
            
            // Крафт предметов
            function setupCrafting() {
                craftCommonLargeBtn.addEventListener('click', () => {
                    if (inventory["Обычный"] >= 10) {
                        inventory["Обычный"] -= 10;
                        inventory["Большая сфера обычного"]++;
                        updateInventoryDisplay();
                    }
                });
                
                craftUncommonLargeBtn.addEventListener('click', () => {
                    if (inventory["Необычный"] >= 10) {
                        inventory["Необычный"] -= 10;
                        inventory["Большая сфера необычного"]++;
                        updateInventoryDisplay();
                    }
                });
                
                craftCoinPotionBtn.addEventListener('click', () => {
                    if (inventory["Большая сфера обычного"] >= 1 && inventory["Большая сфера необычного"] >= 1) {
                        inventory["Большая сфера обычного"] -= 1;
                        inventory["Большая сфера необычного"] -= 1;
                        inventory["Зелье монет"]++;
                        updateInventoryDisplay();
                    }
                });
                // Добавьте другие рецепты крафта здесь
            }
            
            // Анимация для божественного предмета
            function showDivineAnimation() {
                const overlay = document.createElement('div');
                overlay.className = 'animation-overlay';
                
                const divineText = document.createElement('div');
                divineText.className = 'divine-text';
                divineText.textContent = 'БОЖЕСТВЕННЫЙ';
                
                overlay.appendChild(divineText);
                document.body.appendChild(overlay);
                
                // Создание взрыва через 5 секунд
                setTimeout(() => {
                    // Создаем много частиц взрыва
                    for (let i = 0; i < 50; i++) {
                        const explosion = document.createElement('div');
                        explosion.className = 'explosion';
                        explosion.style.backgroundColor = '#e74c3c';
                        explosion.style.left = `${50 + Math.random() * 10 - 5}%`;
                        explosion.style.top = `${50 + Math.random() * 10 - 5}%`;
                        explosion.style.animationDelay = `${Math.random() * 0.5}s`;
                        overlay.appendChild(explosion);
                    }
                    
                    // Удаление оверлея после анимации
                    setTimeout(() => {
                        document.body.removeChild(overlay);
                    }, 1500);
                }, 5000);
            }
            
            // Анимация для вечности
            function showEternityAnimation() {
                const overlay = document.createElement('div');
                overlay.className = 'animation-overlay';
                
                const eternityText = document.createElement('div');
                eternityText.className = 'eternity-text';
                eternityText.textContent = 'ВЕЧНОСТЬ';
                
                overlay.appendChild(eternityText);
                document.body.appendChild(overlay);
                
                // Постепенное заполнение белым
                setTimeout(() => {
                    const whiteOverlay = document.createElement('div');
                    whiteOverlay.className = 'white-overlay';
                    
                    const blackText = document.createElement('div');
                    blackText.className = 'black-text';
                    blackText.textContent = 'быть вечным это быть достойный';
                    
                    whiteOverlay.appendChild(blackText);
                    document.body.appendChild(whiteOverlay);
                    
                    // Удаление оверлея после анимации
                    setTimeout(() => {
                        document.body.removeChild(whiteOverlay);
                        document.body.removeChild(overlay);
                    }, 10000);
                }, 2000);
            }
            
            // Анимация для сердца
            function showHeartAnimation() {
                const overlay = document.createElement('div');
                overlay.className = 'animation-overlay';
                
                const heartText = document.createElement('div');
                heartText.className = 'heart-text';
                heartText.textContent = 'СЕРДЦЕ';
                
                overlay.appendChild(heartText);
                document.body.appendChild(overlay);
                
                // Создание взрыва через 10 секунд
                setTimeout(() => {
                    // Создаем много частиц взрыва
                    for (let i = 0; i < 50; i++) {
                        const explosion = document.createElement('div');
                        explosion.className = 'explosion';
                        explosion.style.backgroundColor = '#e74c3c';
                        explosion.style.left = `${50 + Math.random() * 10 - 5}%`;
                        explosion.style.top = `${50 + Math.random() * 10 - 5}%`;
                        explosion.style.animationDelay = `${Math.random() * 0.5}s`;
                        overlay.appendChild(explosion);
                    }
                    
                    // Удаление оверлея после анимации
                    setTimeout(() => {
                        document.body.removeChild(overlay);
                    }, 1500);
                }, 10000);
            }
            
            // Анимация для ошибки
            function showErrorAnimation() {
                const overlay = document.createElement('div');
                overlay.className = 'animation-overlay';
                
                const errorText = document.createElement('div');
                errorText.className = 'error-text';
                errorText.textContent = 'ERROR';
                
                overlay.appendChild(errorText);
                document.body.appendChild(overlay);
                
                // Эффект лагающих кнопок через 5 секунд
                setTimeout(() => {
                    // Здесь будет код для создания эффекта лагающих кнопок
                    // В реальной реализации это было бы более сложно
                    
                    // Создание взрыва через 15 секунд
                    setTimeout(() => {
                        // Создаем много частиц взрыва
                        for (let i = 0; i < 50; i++) {
                            const explosion = document.createElement('div');
                            explosion.className = 'explosion';
                            explosion.style.backgroundColor = '#8e44ad';
                            explosion.style.left = `${50 + Math.random() * 10 - 5}%`;
                            explosion.style.top = `${50 + Math.random() * 10 - 5}%`;
                            explosion.style.animationDelay = `${Math.random() * 0.5}s`;
                            overlay.appendChild(explosion);
                        }
                        
                        // Удаление оверлея после анимации
                        setTimeout(() => {
                            document.body.removeChild(overlay);
                        }, 2248); // 2.248 секунды
                    }, 15000);
                }, 5000);
            }
            
            // Улучшение перезарядки
            function upgradeCooldown() {
                if (coins >= 25 && cooldownUpgrades < 9) {
                    coins -= 25;
                    cooldown -= 0.5;
                    cooldownUpgrades++;
                    updateCoins();
                    updateCooldown();
                    
                    if (cooldownUpgrades >= 9) {
                        upgradeCooldownBtn.disabled = true;
                        upgradeCooldownBtn.textContent = "Макс. уровень";
                    }
                }
            }
            
            // Удаление предмета
            function removeItem(itemName) {
                const item = items.find(i => i.name === itemName);
                if (item && !item.removed && coins >= getRemoveCost(itemName)) {
                    coins -= getRemoveCost(itemName);
                    item.removed = true;
                    updateCoins();
                    
                    // Удаляем предмет из списка открытых
                    removeDiscoveredItem(itemName);
                    
                    // Отключение кнопки после покупки
                    const button = document.getElementById(`remove-${getItemId(itemName)}`);
                    if (button) {
                        button.disabled = true;
                        button.textContent = "Удалено";
                    }
                }
            }
            
            // Получение стоимости удаления предмета
            function getRemoveCost(itemName) {
                const costMap = {
                    "Обычный": 100,
                    "Необычный": 200,
                    "Редкий": 325,
                    "Повышенный": 500,
                    "Эпический": 1000,
                    "Легендарный": 2000,
                    "Мифический": 3500,
                    "Тень/Свет": 5000,
                    "Фиолетовый": 7500,
                    "КОРОЛЬ": 10000,
                    "АНГЕЛ": 25000,
                    "БОЖЕСТВЕННЫЙ": 50000,
                    "СЕРДЦЕ": 100000
                };
                
                return costMap[itemName] || 0;
            }
            
            // Получение ID предмета для кнопки
            function getItemId(itemName) {
                const idMap = {
                    "Обычный": "common",
                    "Необычный": "uncommon",
                    "Редкий": "rare",
                    "Повышенный": "improved",
                    "Эпический": "epic",
                    "Легендарный": "legendary",
                    "Мифический": "mythical",
                    "Тень/Свет": "shadow-light",
                    "Фиолетовый": "purple",
                    "КОРОЛЬ": "king",
                    "АНГЕЛ": "angel",
                    "БОЖЕСТВЕННЫЙ": "divine",
                    "СЕРДЦЕ": "heart"
                };
                
                return idMap[itemName] || "";
            }
            
            // Назначение обработчиков событий
            spinBtn.addEventListener('click', spin);
            upgradeCooldownBtn.addEventListener('click', upgradeCooldown);
            removeCommonBtn.addEventListener('click', () => removeItem("Обычный"));
            removeUncommonBtn.addEventListener('click', () => removeItem("Необычный"));
            removeRareBtn.addEventListener('click', () => removeItem("Редкий"));
            removeImprovedBtn.addEventListener('click', () => removeItem("Повышенный"));
            removeEpicBtn.addEventListener('click', () => removeItem("Эпический"));
            removeLegendaryBtn.addEventListener('click', () => removeItem("Легендарный"));
            removeMythicalBtn.addEventListener('click', () => removeItem("Мифический"));
            removeShadowLightBtn.addEventListener('click', () => removeItem("Тень/Свет"));
            removePurpleBtn.addEventListener('click', () => removeItem("Фиолетовый"));
            removeKingBtn.addEventListener('click', () => removeItem("КОРОЛЬ"));
            removeAngelBtn.addEventListener('click', () => removeItem("АНГЕЛ"));
            removeDivineBtn.addEventListener('click', () => removeItem("БОЖЕСТВЕННЫЙ"));
            removeHeartBtn.addEventListener('click', () => removeItem("СЕРДЦЕ"));
            
            // Инициализация
            initInventory();
            setupCrafting();
            updateCoins();
            updateCooldown();
        });
    </script>
</body>
</html>
